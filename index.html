<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ø–æ–º–æ—â–Ω–∏–∫ | Telegram Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
    <meta name="description" content="Telegram Mini App –¥–ª—è —É—á–µ—Ç–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤ —Å –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º">
    <meta name="theme-color" content="#4f46e5">
</head>
<body>
    <div class="container">
        <header>
            <h1>üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ø–æ–º–æ—â–Ω–∏–∫</h1>
            <p class="subtitle">–£—á–µ—Ç –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ –¥–ª—è –¥–≤–æ–∏—Ö</p>
        </header>

        <main>
            <section class="card" id="balance-section">
                <h2>üìä –û–±—â–∏–π –±–∞–ª–∞–Ω—Å</h2>
                <p class="total-amount">0 ‚ÇΩ</p>
                <div class="buttons">
                    <button class="btn btn-income" onclick="openIncomeModal()">üì• –î–æ–±–∞–≤–∏—Ç—å –¥–æ—Ö–æ–¥</button>
                    <button class="btn btn-expense" onclick="openExpenseModal()">üì§ –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</button>
                    <button class="btn btn-secondary" onclick="openTransactionsModal()">üìã –ò—Å—Ç–æ—Ä–∏—è</button>
                </div>
            </section>

            <section class="card" id="template-section">
                <h2>üìù –®–∞–±–ª–æ–Ω —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</h2>
                <div id="template-list"></div>
                <button class="btn btn-secondary" onclick="openTemplateModal()">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω</button>
            </section>

            <section class="card" id="stats-section">
                <h2>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                <div class="stats-buttons">
                    <button class="btn btn-small" onclick="openStatsModal()">üìä –ì—Ä–∞—Ñ–∏–∫–∏</button>
                    <button class="btn btn-small" onclick="openTransactionsModal()">üìã –ò—Å—Ç–æ—Ä–∏—è</button>
                </div>
                <div id="stats-content"></div>
            </section>

            <section class="card" id="partners-section">
                <h2>üë• –ü–∞—Ä—Ç–Ω–µ—Ä—ã</h2>
                <p>–¢–∞–Ω—è: <span id="partner1-balance">0 ‚ÇΩ</span></p>
                <p>–°–∞—à–∞: <span id="partner2-balance">0 ‚ÇΩ</span></p>
                <button class="btn btn-secondary" onclick="openPartnerModal()">üîó –û–±—â–∏–π –¥–æ—Å—Ç—É–ø</button>
            </section>

            <section class="card" id="advanced-section">
                <h2>‚öôÔ∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</h2>
                <div class="buttons">
                    <button class="btn btn-secondary" onclick="openPartnerModal()">üë• –û–±—â–∏–π –¥–æ—Å—Ç—É–ø</button>
                    <button class="btn btn-secondary" onclick="openBackupModal()">üíæ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è</button>
                    <button class="btn btn-secondary" onclick="openSettingsModal()">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                </div>
            </section>
        </main>

        <footer>
            <p class="hint">–î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ (localStorage)</p>
        </footer>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="income-modal" class="modal">
        <div class="modal-content">
            <h3>üì• –î–æ–±–∞–≤–∏—Ç—å –¥–æ—Ö–æ–¥</h3>
            <input type="number" id="income-amount" placeholder="–°—É–º–º–∞" min="1" step="100">
            <textarea id="income-description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"></textarea>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal('income-modal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-income" onclick="submitIncome()">–î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="expense-modal" class="modal">
        <div class="modal-content">
            <h3>üì§ –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</h3>
            <input type="number" id="expense-amount" placeholder="–°—É–º–º–∞" min="1" step="100">
            <input type="text" id="expense-category" placeholder="–ö–∞—Ç–µ–≥–æ—Ä–∏—è">
            <select id="expense-person">
                <option value="–¢–∞–Ω—è">–¢–∞–Ω—è</option>
                <option value="–°–∞—à–∞">–°–∞—à–∞</option>
            </select>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal('expense-modal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-expense" onclick="submitExpense()">–î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="template-modal" class="modal">
        <div class="modal-content">
            <h3>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω</h3>
            <div id="template-edit-list"></div>
            <button class="btn btn-small" onclick="addTemplateRow()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É</button>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal('template-modal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-income" onclick="saveTemplate()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="stats-modal" class="modal">
        <div class="modal-content">
            <h3>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <div class="stats-period">
                <button class="btn-period active" onclick="changeStatsPeriod('day')">–î–µ–Ω—å</button>
                <button class="btn-period" onclick="changeStatsPeriod('week')">–ù–µ–¥–µ–ª—è</button>
                <button class="btn-period" onclick="changeStatsPeriod('month')">–ú–µ—Å—è—Ü</button>
            </div>
            <canvas id="stats-chart"></canvas>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal('stats-modal')">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="transactions-modal" class="modal">
        <div class="modal-content">
            <h3>üìã –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h3>
            <div id="transactions-list"></div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal('transactions-modal')">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="partner-modal" class="modal">
        <div class="modal-content">
            <h3>üë• –û–±—â–∏–π –¥–æ—Å—Ç—É–ø</h3>
            <div class="partner-status" id="partner-status"></div>
            <div id="partner-invite-section" style="display: none;">
                <h4>–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –ø–∞—Ä—Ç–Ω–µ—Ä–∞</h4>
                <div class="invite-code">
                    <input type="text" id="partner-code-input" readonly>
                    <button class="btn btn-small" onclick="copyPartnerCode()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
                <p class="hint">–û—Ç–ø—Ä–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –ø–∞—Ä—Ç–Ω–µ—Ä—É</p>
            </div>
            <div id="partner-join-section" style="display: none;">
                <h4>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</h4>
                <input type="text" id="partner-join-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è">
                <div class="modal-buttons">
                    <button class="btn btn-secondary" onclick="closeModal('partner-modal')">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-income" onclick="joinPartner()">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</button>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal('partner-modal')">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="backup-modal" class="modal">
        <div class="modal-content">
            <h3>üíæ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è</h3>
            <div class="backup-section">
                <h4>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h4>
                <textarea id="export-data" readonly rows="6"></textarea>
                <button class="btn btn-small" onclick="copyExportData()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å JSON</button>
                <button class="btn btn-small" onclick="downloadBackup()">üì• –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª</button>
            </div>
            <div class="backup-section">
                <h4>–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h4>
                <textarea id="import-data" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ JSON –¥–∞–Ω–Ω—ã–µ..." rows="6"></textarea>
                <div class="modal-buttons">
                    <button class="btn btn-secondary" onclick="closeModal('backup-modal')">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-income" onclick="importBackup()">–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
            </div>
            <div class="danger-zone">
                <h4 style="color: #ef4444;">‚ö†Ô∏è –û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞</h4>
                <button class="btn btn-expense" onclick="resetMonthData()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å –º–µ—Å—è—Ü</button>
                <p class="hint">–û–±–Ω—É–ª–∏—Ç –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –±–∞–ª–∞–Ω—Å—ã</p>
            </div>
        </div>
    </div>

    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
            <div class="setting-item">
                <label>
                    <input type="checkbox" id="setting-notifications" checked>
                    <span>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</span>
                </label>
            </div>
            <div class="setting-item">
                <label>
                    <input type="checkbox" id="setting-monthly-reset">
                    <span>–°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Ü–µ –º–µ—Å—è—Ü–∞</span>
                </label>
            </div>
            <div class="setting-item">
                <label>–í–∞–ª—é—Ç–∞:</label>
                <select id="setting-currency">
                    <option value="‚ÇΩ">–†—É–±–ª–∏ (‚ÇΩ)</option>
                    <option value="$">–î–æ–ª–ª–∞—Ä—ã ($)</option>
                    <option value="‚Ç¨">–ï–≤—Ä–æ (‚Ç¨)</option>
                    <option value="¬•">–ò–µ–Ω—ã (¬•)</option>
                </select>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal('settings-modal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-income" onclick="saveSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script src="data.js"></script>
    <script src="app.js"></script>
</body>
</html>
