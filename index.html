<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üí∞ –§–∏–Ω–∞–Ω—Å—ã –≤ –ø–∞—Ä–µ</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <meta name="theme-color" content="#6366f1">
    <style>
        .telegram-bg {
            background: var(--tg-theme-bg-color, #f8fafc);
            color: var(--tg-theme-text-color, #1e293b);
        }
    </style>
</head>
<body class="telegram-bg">
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div class="container">
        <!-- –®–∞–ø–∫–∞ -->
        <header class="header">
            <div class="header-top">
                <div class="user-info">
                    <div class="user-avatar" id="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="user-details">
                        <h1 id="user-name">–§–∏–Ω–∞–Ω—Å—ã</h1>
                        <p class="user-status" id="user-status">–õ–∏—á–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å—ã</p>
                    </div>
                </div>
                <button class="icon-btn" onclick="openSettings()">
                    <i class="fas fa-cog"></i>
                </button>
            </div>

            <!-- –û–±—â–∏–π –±–∞–ª–∞–Ω—Å -->
            <div class="total-balance-card">
                <div class="balance-main">
                    <span class="balance-label">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å</span>
                    <span class="balance-amount" id="total-balance">0 ‚ÇΩ</span>
                </div>
                <div class="balance-period">
                    <select class="period-select" id="period-select" onchange="changePeriod(this.value)">
                        <option value="current">–¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü</option>
                        <option value="day">–°–µ–≥–æ–¥–Ω—è</option>
                        <option value="week">–ù–µ–¥–µ–ª—è</option>
                        <option value="all">–ó–∞ –≤—Å—ë –≤—Ä–µ–º—è</option>
                    </select>
                </div>
            </div>
        </header>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="main">
            <!-- –ö–Ω–æ–ø–∫–∏ –±—ã—Å—Ç—Ä—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π -->
            <div class="quick-actions">
                <button class="action-btn income" onclick="openAddModal('income')">
                    <i class="fas fa-plus-circle"></i>
                    <span>–î–æ—Ö–æ–¥</span>
                </button>
                <button class="action-btn expense" onclick="openAddModal('expense')">
                    <i class="fas fa-minus-circle"></i>
                    <span>–†–∞—Å—Ö–æ–¥</span>
                </button>
                <button class="action-btn transfer" onclick="openTransferModal()">
                    <i class="fas fa-exchange-alt"></i>
                    <span>–ü–µ—Ä–µ–≤–æ–¥</span>
                </button>
                <button class="action-btn partners" onclick="openPartnersModal()">
                    <i class="fas fa-user-plus"></i>
                    <span>–ü–∞—Ä—Ç–Ω—ë—Ä</span>
                </button>
            </div>

            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –±–∞–ª–∞–Ω—Å–∞–º–∏ -->
            <section class="categories-section">
                <div class="section-header">
                    <h2><i class="fas fa-list"></i> –ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
                    <button class="btn-text" onclick="openCategoriesModal()">–ò–∑–º–µ–Ω–∏—Ç—å</button>
                </div>
                
                <div class="categories-list" id="categories-list">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è -->
                </div>
            </section>

            <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
            <section class="recent-transactions">
                <div class="section-header">
                    <h2><i class="fas fa-history"></i> –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</h2>
                    <button class="btn-text" onclick="showAllTransactions()">–í—Å–µ</button>
                </div>
                
                <div class="transactions-container" id="recent-transactions">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è -->
                </div>
            </section>

            <!-- –ö–Ω–æ–ø–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ —à–∞–±–ª–æ–Ω–æ–≤ -->
            <div class="bottom-actions">
                <button class="bottom-btn" onclick="openStatsModal()">
                    <i class="fas fa-chart-pie"></i>
                    <span>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                </button>
                <button class="bottom-btn" onclick="openTemplatesModal()">
                    <i class="fas fa-percentage"></i>
                    <span>–®–∞–±–ª–æ–Ω—ã %</span>
                </button>
                <button class="bottom-btn" onclick="openBackupModal()">
                    <i class="fas fa-download"></i>
                    <span>–≠–∫—Å–ø–æ—Ä—Ç</span>
                </button>
            </div>
        </main>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
    <div id="add-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">–î–æ–±–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é</h3>
                <button class="modal-close" onclick="closeAddModal()">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="form-group">
                    <label for="amount">–°—É–º–º–∞ (‚ÇΩ)</label>
                    <input type="number" id="amount" placeholder="0" min="1" step="100">
                </div>
                
                <div class="form-group">
                    <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <input type="text" id="description" placeholder="–ù–∞ —á—Ç–æ –ø–æ—Ç—Ä–∞—Ç–∏–ª–∏?">
                </div>
                
                <div class="form-group">
                    <label for="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select id="category">
                        <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </select>
                </div>
                
                <div class="form-group" id="distribution-group">
                    <label>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:</label>
                    <div class="distribution-options">
                        <label class="radio-label">
                            <input type="radio" name="distribution" value="specific" checked>
                            <span>–ò–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="distribution" value="all">
                            <span>–†–∞–≤–Ω–æ –∏–∑ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="distribution" value="percentage">
                            <span>–ü–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º –∏–∑ –≤—Å–µ—Ö</span>
                        </label>
                    </div>
                </div>
                
                <div class="form-group" id="date-group">
                    <label for="date">–î–∞—Ç–∞</label>
                    <input type="date" id="date">
                </div>
                
                <div class="form-group" id="template-group" style="display: none;">
                    <label for="template">–®–∞–±–ª–æ–Ω —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</label>
                    <select id="template">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —à–∞–±–ª–æ–Ω</option>
                    </select>
                </div>
                
                <div class="modal-actions">
                    <button class="btn-secondary" onclick="closeAddModal()">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn-primary" id="modal-submit-btn" onclick="submitTransaction()">–î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤ -->
    <div id="partners-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-users"></i> –ü–∞—Ä—Ç–Ω—ë—Ä—ã</h3>
                <button class="modal-close" onclick="closeModal('partners-modal')">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="partners-list" id="partners-list">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è -->
                </div>
                
                <div class="add-partner-form">
                    <h4>–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—Ç–Ω—ë—Ä–∞</h4>
                    <div class="form-group">
                        <input type="text" id="partner-username" placeholder="@username –≤ Telegram">
                        <button class="btn-small" onclick="addPartner()">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </div>
                    <p class="hint">–ü–∞—Ä—Ç–Ω—ë—Ä –ø–æ–ª—É—á–∏—Ç –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–æ—Å–º–æ—Ç—Ä—É –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é</p>
                </div>
                
                <div class="share-link">
                    <h4>–°—Å—ã–ª–∫–∞ –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</h4>
                    <div class="link-container">
                        <input type="text" id="share-link" readonly>
                        <button class="btn-small" onclick="copyShareLink()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
    <div id="stats-modal" class="modal">
        <div class="modal-content wide">
            <div class="modal-header">
                <h3><i class="fas fa-chart-bar"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                <button class="modal-close" onclick="closeModal('stats-modal')">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="stats-period-selector">
                    <button class="period-btn active" data-period="month">–ú–µ—Å—è—Ü</button>
                    <button class="period-btn" data-period="week">–ù–µ–¥–µ–ª—è</button>
                    <button class="period-btn" data-period="all">–í—Å–µ –≤—Ä–µ–º—è</button>
                </div>
                
                <div class="stats-charts">
                    <canvas id="expenses-chart"></canvas>
                    <canvas id="income-chart"></canvas>
                </div>
                
                <div class="stats-summary">
                    <div class="stat-card">
                        <div class="stat-label">–í—Å–µ–≥–æ –¥–æ—Ö–æ–¥–æ–≤</div>
                        <div class="stat-value income" id="total-income">0 ‚ÇΩ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–í—Å–µ–≥–æ —Ä–∞—Å—Ö–æ–¥–æ–≤</div>
                        <div class="stat-value expense" id="total-expense">0 ‚ÇΩ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–û—Å—Ç–∞—Ç–æ–∫</div>
                        <div class="stat-value" id="total-balance-stat">0 ‚ÇΩ</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
    <div id="categories-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</h3>
                <button class="modal-close" onclick="closeModal('categories-modal')">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="categories-edit-list" id="categories-edit-list">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è -->
                </div>
                
                <div class="add-category-form">
                    <h4>–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h4>
                    <div class="form-row">
                        <input type="text" id="new-category-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
                        <input type="number" id="new-category-percent" placeholder="%" min="0" max="100">
                        <button class="btn-small" onclick="addCategory()">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button class="btn-primary" onclick="saveCategories()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π -->
    <div id="transactions-modal" class="modal">
        <div class="modal-content wide">
            <div class="modal-header">
                <h3><i class="fas fa-receipt"></i> –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</h3>
                <button class="modal-close" onclick="closeModal('transactions-modal')">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="transactions-filter">
                    <select id="transactions-filter" onchange="filterTransactions()">
                        <option value="all">–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</option>
                        <option value="income">–¢–æ–ª—å–∫–æ –¥–æ—Ö–æ–¥—ã</option>
                        <option value="expense">–¢–æ–ª—å–∫–æ —Ä–∞—Å—Ö–æ–¥—ã</option>
                        <option value="month">–≠—Ç–æ—Ç –º–µ—Å—è—Ü</option>
                    </select>
                </div>
                
                <div class="all-transactions" id="all-transactions">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è -->
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —à–∞–±–ª–æ–Ω–æ–≤ -->
    <div id="templates-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-layer-group"></i> –®–∞–±–ª–æ–Ω—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</h3>
                <button class="modal-close" onclick="closeModal('templates-modal')">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="templates-list" id="templates-list">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è -->
                </div>
                
                <div class="add-template-form">
                    <h4>–°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω</h4>
                    <div class="form-group">
                        <input type="text" id="template-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞">
                    </div>
                    <div class="template-categories" id="template-categories-edit">
                        <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è -->
                    </div>
                    <button class="btn-primary" onclick="createTemplate()">–°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-sliders-h"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                <button class="modal-close" onclick="closeModal('settings-modal')">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="settings-group">
                    <h4>–û—Å–Ω–æ–≤–Ω—ã–µ</h4>
                    <div class="setting-item">
                        <label>–í–∞–ª—é—Ç–∞</label>
                        <select id="currency-select">
                            <option value="‚ÇΩ">–†—É–±–ª–∏ (‚ÇΩ)</option>
                            <option value="$">–î–æ–ª–ª–∞—Ä—ã ($)</option>
                            <option value="‚Ç¨">–ï–≤—Ä–æ (‚Ç¨)</option>
                            <option value="¬•">–ò–µ–Ω—ã (¬•)</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="notifications-toggle" checked>
                            <span>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                        </label>
                    </div>
                </div>
                
                <div class="settings-group">
                    <h4>–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è</h4>
                    <div class="backup-actions">
                        <button class="btn-secondary" onclick="exportData()">
                            <i class="fas fa-file-export"></i> –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                        </button>
                        <button class="btn-secondary" onclick="importData()">
                            <i class="fas fa-file-import"></i> –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                        </button>
                    </div>
                    <div class="danger-zone">
                        <h4><i class="fas fa-exclamation-triangle"></i> –û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞</h4>
                        <button class="btn-danger" onclick="resetData()">
                            <i class="fas fa-trash"></i> –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div id="notification" class="notification"></div>

    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="data.js"></script>
    <script src="app.js"></script>
</body>
</html>
